1 ' New System Menu (GFX)
2 CLS : SCREEN 2 : BLITT 2
5 DIM MT$(3) : MT$(1)="Settings" : MT$(2)="Applications" : MT$(3)="Medias"
6 DIM ITMS(20) : ' items indexes
7 GOSUB 6000
10 DRAWSPRT "SYSMENU",0,0,32,32,0,0
20 BLITT 0 : CLS : RECT 0,0,320,240,2,1 : ' CLS to release text
25 Y = 64 : CH = 1 : ' 2nd item by def.
28 ' Icons
30 DRAWSPRT "",60-12+0,Y,64,64,0,0
40 DRAWSPRT "",60+64+4,Y,64,64,64,0
50 DRAWSPRT "",60+12+128+8,Y,64,64,0,64
58 ' Texts
60 DRAWSPRT "",60-12+0,Y+64+8,64,24,64,64+2
70 DRAWSPRT "",60+64+4,Y+64+8,64,24-4,64,64+24+2
80 DRAWSPRT "",60+12+128+8,Y+64+8,64,24-8,64,64+24+24
90 BLITT 2
100 ' Rects
110 RECT 60-12-4, Y-4, 64+8, 64+8, 2, 0
120 RECT 60+64, Y-4, 64+8, 64+8, 2, 0
130 RECT 60+12+128+4, Y-4, 64+8, 64+8, 2, 0
210 IF CH=0 THEN RECT 60-12-4, Y-4, 64+8, 64+8, 1, 0
220 IF CH=1 THEN RECT 60+64, Y-4, 64+8, 64+8, 1, 0
230 IF CH=2 THEN RECT 60+12+128+4, Y-4, 64+8, 64+8, 1, 0
300 MV = 0 : EXP=0
305 IF ( BTN(4) = 1 ) THEN MV=1 : CH=CH-1 : IF CH<0 THEN CH=2
310 IF ( BTN(5) = 1 ) THEN MV=1 : CH=CH+1 : IF CH>2 THEN CH=0
380 IF ( BTN(1) = 1 ) THEN EXP=1
390 DELAY 250
395 ' IF BTN(4)=1 OR BTN(5)=1 OR BTN(3)=1 OR BTN(1)=1 THEN GOTO 390
397 IF EXP=1 THEN GOTO 1000
398 IF MV <> 0 THEN GOTO 100
400 GOTO 300
1000 ' draw expanded menu
1010 RECT 24,24,320-48,240-48, 0, 1
1020 RECT 24,24,320-48,240-48, 1, 0
1030 LOCATE 4,4 : ? MT$( CH+1 );
1050 CPT=0 : SCH=0
1055 LOCATE 4+1,6+SCH : ? ">";
1060 FOR Z=1 TO SZ
1070 LOCATE 4+3,6+CPT
1090 IF CH=0 AND CT$(Z)="S" THEN ? LB$(Z); : ITMS(CPT+1) = Z : CPT = CPT+1
1100 IF CH=1 AND CT$(Z)="A" THEN ? LB$(Z); : ITMS(CPT+1) = Z : CPT = CPT+1
1110 IF CH=2 AND CT$(Z)="M" THEN ? LB$(Z); : ITMS(CPT+1) = Z : CPT = CPT+1
1900 NEXT Z
2000 MV=0 : BCK=0
2100 IF ( BTN(6) = 1 ) THEN MV=1 : SCH=SCH-1 : IF SCH<0 THEN SCH=CPT-1
2110 IF ( BTN(7) = 1 ) THEN MV=1 : SCH=SCH+1 : IF SCH>CPT-1 THEN SCH=0
2120 IF ( BTN(3) = 1 ) THEN BCK=1
2140 IF ( BTN(1) = 1 ) THEN DELAY 250 : GOSUB 7000
2150 DELAY 250
2155 ' IF BTN(6)=1 OR BTN(7)=1 OR BTN(3)=1 OR BTN(1)=1 THEN GOTO 2155
2157 IF BCK=1 THEN GOTO 20 : ' 20 Cf just back else 10 !
2200 IF MV=1 THEN FOR Z=0 TO CPT : LOCATE 4+1,6+Z : ? " "; : NEXT Z
2250 LOCATE 4+1,6+SCH : ? ">";
2270 MV=0
2570 GOTO 2100
6000 ' load menu datas
6010 DATAF "SYSMENU", "SZ", "CT$", "LB$", "TY$", "CM$"
6020 ? CT$(1) ; " "; LB$(1); " "; TY$(1); " "; CM$(1); 
6030 ' INPUT A$
6999 RETURN
7000 ' Run selected Line/Cmd/Prgm
7001 MV=0
7005 IF BTN(0) <> 0 THEN DELAY 100 : GOTO 7005
7010 ITMLN = ITMS(SCH+1)
7015 CC$ = CM$(ITMLN)+": CHAIN "+STRING$(1,34)+"NEWMENU"+STRING$(1,34)
7020 IF TY$( ITMLN ) = "L" THEN MV=1 : GOSUB VAL( CM$(ITMLN) )
7050 IF TY$( ITMLN ) = "C" THEN MV=1 : DO CC$
7100 IF TY$( ITMLN ) = "P" THEN MV=1 : CHAIN CM$(ITMLN)
7200 IF MV=1 THEN MV=0 : GOTO 10
7850 IF BTN(3)=1 OR BTN(1)=1 THEN GOTO 7850
7999 RETURN
10000 ' set volume subroutine
10010 CLS
10020 ? "HERE : we sets the Volume"
10800 IF BTN(1) = 0 THEN GOTO 10800
10850 IF BTN(3) OR BTN(1) THEN GOTO 10850
10999 RETURN
